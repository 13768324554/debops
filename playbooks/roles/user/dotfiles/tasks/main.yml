---

# This set of tasks should be run under sudo = yes
# Usage:
#
# - hosts: all
#   roles:
#     - { role: user/dotfiles, owner: username, dotfile: dotfile_hash }
#
# Look in ../vars/main.yml for available hashes

- name: DOTFILES ({{ owner }}) | Clone '{{ user_dotfiles[dotfile].git_repo }}' repository
  sudo_user: ${owner}
  git: repo={{ user_dotfiles[dotfile].git_repo }} dest=~/.dotfiles update=yes
  tags:
    - user
    - dotfiles

- name: DOTFILES ({{ owner }}) | Install dotfiles
  command: chdir=~/.dotfiles creates="{{user_dotfiles[dotfile].creates}}" {{ user_dotfiles[dotfile].command }}
  sudo_user: ${owner}
  tags:
    - user
    - dotfiles

- name: DOTFILES ({{ owner }}) | Change shell to {{ user_dotfiles[dotfile].shell }}
  user: name=${owner} shell={{ user_dotfiles[dotfile].shell }}
  tags:
    - user
    - dotfiles

