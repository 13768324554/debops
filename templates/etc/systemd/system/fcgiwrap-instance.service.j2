# {{ ansible_managed }}

[Unit]
Description=Simple CGI Server for {{ item.0.name }}
After=nss-user-lookup.target
Requires=fcgiwrap-{{ item.0.name }}.socket

{% set fcgiwrap_tpl_options = { 'value': '' } %}
{% for key, value in fcgiwrap_options_map.iteritems() %}
{% if fcgiwrap_register_version.stdout|d() | version_compare(key, '>=') %}
{% set _ = fcgiwrap_tpl_options.update({ 'value': value }) %}
{% endif %}
{% endfor %}
[Service]
User={{ item.0.user | d(fcgiwrap_user) }}
Group={{ item.0.group | d(fcgiwrap_group) }}
ExecStart=/usr/sbin/fcgiwrap {{ fcgiwrap_tpl_options['value'] }}

[Install]
WantedBy=multi-user.target
Also=fcgiwrap-{{ item.0.name }}.socket

