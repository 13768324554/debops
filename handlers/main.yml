---

- name: Restart postfix
  service:
    name: 'postfix'
    state: 'restarted'
  notify: [ 'Restart ferm' ]

- name: Generate postfix hash aliases
  command: make chdir=/etc/postfix/hash_aliases
  notify: [ 'Check postfix and reload' ]

- name: Generate postfix hash tables
  command: make chdir=/etc/postfix/hash_tables
  notify: [ 'Check postfix and reload' ]

- name: Generate postfix private hash tables
  command: make chdir=/etc/postfix/private_hash_tables
  notify: [ 'Check postfix and reload' ]

- name: Check postfix
  command: /usr/sbin/postfix -c /etc/postfix check

- name: Check postfix and reload
  command: /usr/sbin/postfix -c /etc/postfix check
  notify: [ 'Reload postfix' ]

- name: Reload postfix
  service:
    name: 'postfix'
    state: 'reloaded'

- name: Generate mail alias database
  command: newaliases

