---
# Default variables
# =================

# .. contents:: Sections
#    :local:
#
# .. Packages and installation (((
#
# -----------------------------
#   Packages and installation
# -----------------------------

# .. envvar:: apparmor_base_packages
#
# List of base packages to install.
apparmor_base_packages:
  - 'apparmor'
  - 'apparmor-utils'
  - 'apparmor-profiles'
  - 'apparmor-profiles-extra'


# .. envvar:: apparmor_packages
#
# List of additional packages to install with AppArmor.
#
# Example::
#
#    apparmor_packages:
#      - 'apparmor-notify'
#
apparmor_packages: []


# .. envvar:: apparmor_enabled
#
# Should AppArmor be enabled?
apparmor_enabled: True


# .. envvar:: apparmor_kernel_options
#
# Default kernel options needed to enable AppArmor.
# You probably donâ€™t need to change this.
apparmor_kernel_options:
  - 'apparmor=1'
  - 'security=apparmor'


# .. envvar:: apparmor_manage_grub
#
# How should role write the required kernel options into the Grub configuration.
# The default is delegate this to the ``debops.grub`` role.
# If set to False, this role will do that internally without ``debops.grub``.
# Note that this role is not as flexible in configuring Grub as ``debops.grub`` is.
apparmor_manage_grub: False


# .. envvar:: apparmor_additional_kernel_parameters
#
# Legacy:
# Only considered when `apparmor_manage_grub == True`.
apparmor_additional_kernel_parameters: ''


# .. envvar:: apparmor_mail_to
#
# List of recipients to which a mail will be send in case a reboot is required.
apparmor_mail_to: [ 'root@{{ ansible_domain }}' ]


# .. envvar:: apparmor_mail_subject
#
# Subject of the Email to be send in case a reboot is required to boot into a
# updated kernel version.
apparmor_mail_subject: 'Reboot required by AppArmor on {{ ansible_fqdn }}'


# .. envvar:: apparmor_mail_body
#
# Body of the Email to be send in case a reboot is required to boot into a
# updated kernel version.
apparmor_mail_body: |
  Ansible has enabled AppArmor thought the boot loader configuration for the
  Linux kernel parameters on host {{ ansible_fqdn }}.
  You should check the status of the host and reboot it when convenient.

# .. )))

# .. AppArmor profiles (((
#
# ---------------------
#   AppArmor profiles
# ---------------------

# .. envvar:: apparmor_enforce_all_profiles
#
# Put all profiles into enforcement mode.
# Use this only if you know what you are doing.
apparmor_enforce_all_profiles: False


# .. envvar:: apparmor_global_profile_status
#
# Global configuration of the status of individual profiles.
# More specific matches overwrite more generic matches (example host overrules
# global).
#
# Choices are:
#
# ``enforce``
#   Result in enforcement of the policy defined in the profile as well as
#   logging policy violation attempts.
#
# ``complain``
#  This will not enforce the policy.  Instead, it will log policy violations.
#
# ``disable``
#   In this mode, policy violations are neither prevented nor logged.
#
# Example::
#
#    apparmor_global_profile_status:
#      'usr.sbin.nmbd': 'complain'
#
apparmor_global_profile_status: {}


# .. envvar:: apparmor_host_group_profile_status
#
# Host group configuration of the status of individual profiles.
apparmor_host_group_profile_status: {}


# .. envvar:: apparmor_host_profile_status
#
# Host configuration of the status of individual profiles.
apparmor_host_profile_status: {}


# .. envvar:: apparmor_local_config_global
#
# Global additions or overrides of system profiles.
# Those changes will be configured in :file:`/etc/apparmor.d/local/`.
# Check :file:`/etc/apparmor.d/local/README` for details.
# All three dictionaries are merged into one profile configuration.
#
# Example::
#
#    apparmor_local_config_global:
#
#      'usr.sbin.dnsmasq':
#        - comment: 'Allow dnsmasq to read upstream DNS servers'
#          rules:
#            - '/etc/resolvconf/upstream.conf r'
#            - '/etc/hosts.dnsmasq r'
#        - comment: 'Allow dnsmasq to read /usr/share/dnsmasq-base/trust-anchors.conf'
#          rules:
#            - '/usr/share/dnsmasq-base/* r'
#
#      'usr.bin.pidgin':
#        - comment: 'Allow local Pidgin plugins'
#          rules:
#            - '@{HOME}/.purple/plugins/** rm'
#
apparmor_local_config_global: {}


# .. envvar:: apparmor_local_config_host_group
#
# Host group additions or overrides of system profiles.
apparmor_local_config_host_group: {}


# .. envvar:: apparmor_local_config_host
#
# Host additions or overrides of system profiles.
apparmor_local_config_host: {}


# .. envvar:: apparmor_tunables_global
#
# Allows you to define or append variables which will be included by most
# profiles via the tunable concept of AppArmor.
# See also: https://wiki.ubuntu.com/DebuggingApparmor#Adjusting_Tunables
#
# Example::
#
#    apparmor_tunables_global: |
#      @{HOMEDIRS}+=/exports/home/
#
apparmor_tunables_global: ''


# .. envvar:: apparmor_tunables_host_group
#
# Host group additions or overrides of system profiles.
apparmor_tunables_host_group: ''


# .. envvar:: apparmor_tunables_host
#
# Host additions or overrides of system profiles.
apparmor_tunables_host: ''

# .. )))
