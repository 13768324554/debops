---
# .. vim: foldmarker=[[[,]]]:foldmethod=marker

# debops-contrib.kernel_module default variables [[[
# ==================================================

# .. contents:: Sections
#    :local:
#
# .. include:: includes/all.rst


# Configuration presets [[[
# -------------------------

# .. envvar:: kernel_module_security_list [[[
#
# A preset of kernel module configuration intended to increase the security of
# the system against known attacks.
kernel_module_security_list:

  ## Protecting against Firewire DMA: https://security.stackexchange.com/a/49158/79474
  - name: 'firewire-sbp2'
    blacklist: True

  ## http://wiki.qemu.org/Features-Done/VirtIORNG
  ## https://serverfault.com/questions/437798/is-it-possible-to-pass-dev-urandom-through-from-the-host-to-a-qemu-kvm-guest
  - name: 'virtio_rng'
    state: '{{ "present"
               if (ansible_virtualization_role|d("guest") in [ "guest" ] and
                   ansible_virtualization_type|d("unknown") in ["kvm"]
               )
               else "absent" }}'

                                                                   # ]]]
# .. envvar:: kernel_module_common_list [[[
#
# A preset of kernel module configuration which is often chosen.
kernel_module_common_list:
  - name: 'pcspkr'
    blacklist: True
                                                                   # ]]]
                                                                   # ]]]
# Lists of module definitions [[[
# -------------------------------

# .. envvar:: kernel_module_list [[[
#
# "Global" kernel module configuration.
#
# For more details refer to :ref:`kernel_module__ref_kernel_module_list`
# in the :ref:`kernel_module__ref_default_variable_details` section.
kernel_module_list: |
  {{
    kernel_module_security_list|list +
    kernel_module_common_list|list
  }}

                                                                   # ]]]
# .. envvar:: kernel_module_group_list [[[
#
# "Host group" kernel module configuration.
kernel_module_group_list: []

                                                                   # ]]]
# .. envvar:: kernel_module_host_list [[[
#
# "Host" kernel module configuration.
kernel_module_host_list: []
                                                                   # ]]]
                                                                   # ]]]
# Default options [[[
# -------------------

# .. envvar:: kernel_module_params_force [[[
#
# If ``True``, force that the module parameters are applied (via unloading and
# loading of the module).
kernel_module_params_force: False
                                                                   # ]]]
                                                                   # ]]]
# Configuration files used for configuring [[[
# --------------------------------------------

# .. envvar:: kernel_module_blacklist_file [[[
#
# FIXME
kernel_module_blacklist_file: '/etc/modprobe.d/blacklist-ansible-kernel_module-role.conf'

                                                                   # ]]]
# .. envvar:: kernel_module_options_file [[[
#
# FIXME
kernel_module_options_file: '/etc/modprobe.d/options-ansible-kernel_module-role.conf'

                                                                   # ]]]
# .. envvar:: kernel_module_load_file [[[
#
# FIXME
kernel_module_load_file: '/etc/modules-load.d/ansible-kernel_module-role.conf'
                                                                   # ]]]
                                                                   # ]]]
                                                                   # ]]]
