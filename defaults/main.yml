---

# Active Postfix capabilities (see README.md). By default Postfix is configured
# with local mail disabled, all mail is sent to local domain MX server
postfix: [ 'null' ]

# Address of mail host this host should relay all mail to instead of delivering
# it directly. (Automatic configuration)
postfix_relayhost: False


# Configuration options for Postfix. Many options are configured automatically
# using templates, here you can (mostly) add your own entries to Postfix lists
# (look in Postfix manual for details), they will by added or replaced in
# templates.

# Mail host name configured in /etc/mailname
postfix_mailname: '{{ ansible_fqdn }}'

# How long to wait before notifying users about delivery problems
postfix_delay_warning_time: '4h'

# List of relay domains this host accepts
postfix_relay_domains: []

# On what interfaces postfix should listen to by default (not a list). (Automatic configuration)
postfix_inet_interfaces: False

# List of local domains accepted by postfix. (Automatic configuration)
postfix_mydestination: []

# List of networks postfix accepts by default. (localhost is always enabled)
postfix_mynetworks: []

# List of postfix transport maps. (Automatic configuration)
postfix_transport_maps: []

# List of postfix virtual alias maps. (Automatic configuration)
postfix_virtual_alias_maps: []

# Message size limit in megabytes
postfix_message_size_limit: 50


# ---- PKI / TLS configuration ----

# Base PKI directory. Set to False to disable TLS support
postfix_pki: '{{ ansible_local.pki.base_path | default("/etc/pki") }}'

# Default PKI realm used by Postfix
postfix_pki_realm: '{{ ansible_local.pki.realm | default("system") }}'

# Default certificate, private key and DHE parameters used by Postfix, relative
# to 'postfix_pki_realm' variable
postfix_pki_crt: 'default.crt'
postfix_pki_key: 'default.key'
postfix_pki_dhparam: 'dhparam.pem'


# Firewall configuration. If network and any of needed Postfix capabilities are
# enabled, all hosts can send mail to this Postfix instance. You can limit
# access to specific hosts or networks using lists below.
postfix_allow_smtp: []
postfix_allow_submission: []
postfix_allow_smtps: []


# A map of SMTP SASL passwords used in SMTP client authentication by Postfix.
# You need to add 'client' in postfix capabilities to enable this feature.
# Format of the entries:
#   'smtp.example.org': 'username'
#   'user@example.org': 'username'
# Passwords are stored in a secret directory, in path:
# 'secret/credentials/{{ ansible_fqdn }}/postfix/smtp_sasl_password_map/{{ key }}/{{ value }}'
# - key   = hostname or email address of the sender
# - value = username on the remote host
# Postfix role will generate random passwords by default. To change them to
# your actual passwords, open the files with passwords in the secret directory
# and replace them, then re-run the playbook with the role.
postfix_smtp_sasl_password_map: {}

# A map of sender dependent relayhosts used in SMTP client mail relay by Postfix.
# You need to add 'client' and 'sender_dependent' in postfix capabilities to
# enable this feature.
# Format of the entries:
#   'sender-address': 'relay-host'
#   'user@example.org': '[smtp.example.org]:submission'
postfix_sender_dependent_relayhost_map: {}


# Mail archive configuration
# Archiving is enabled by 'archive' option in Postfix capabilities.
# Remember that an archive account on the receiving server needs to exist.

# Method of archiving:
#   - 'all':            send all mail without sorting
#   - 'domain':         send mail sorted by domain
#   - 'domain-account': send mail sorted by domain and account, divided by separator
postfix_archive_method: 'all'

# Optional address of a mail account to send the archived mails to. If not
# specified, Ansible will generate an address by itself in format:
#   - postfix_archive_account @ ansible_fqdn (if local mail is enabled)
#   - postfix_archive_account @ postfix_archive_subdomain.ansible_domain
#     (if local mail is disabled).
postfix_archive_to: ''

# Mail account to send archived mail to (used by Ansible to generate archive address).
postfix_archive_account: 'mail-archive'

# Subdomain part of a domain used to generate archive address, if 'local' mail
# is not enabled in Postfix capabilities (dot at the end is required).
postfix_archive_subdomain: 'archive.'

# Separator used to separate domain and account part in sorted archive mails.
# If you use virtual mail delivery, you can sort mail into subdirectories by
# setting separator as '/' (does not work on local mail delivery).
postfix_archive_separator: '='

# List of domains to archive, if it's empty, everything is archived.
postfix_archive_domains: []


# Postscreen blacklists
postfix_postscreen_dnsbl_sites:

  # Spamhaus ZEN: http://www.spamhaus.org/zen/
  # Might require registration
  - 'zen.spamhaus.org*3'

  # Barracuda Reputation Block List: http://barracudacentral.org/rbl
  # Requires registration
  #- 'b.barracudacentral.org*2'

  # Spam Eating Monkey: http://spameatingmonkey.com/lists.html
  # Might require registration
  - 'bl.spameatingmonkey.net*2'
  - 'backscatter.spameatingmonkey.net*2'

  # SpamCop Blocking List: http://www.spamcop.net/bl.shtml
  - 'bl.spamcop.net'

  # Passive Spam Block List: http://psbl.org/
  - 'psbl.surriel.com'

  # mailspike: http://mailspike.net/usage.html
  # Might require contact
  - 'bl.mailspike.net'


# Postscreen whitelists
postfix_postscreen_dnswl_sites:

  # SpamHaus Whitelist: http://www.spamhauswhitelist.com/en/usage.html
  # Might require registration
  - 'swl.spamhaus.org*-4'

  # DNS Whitelist: http://dnswl.org/tech
  # Might require registration
  - 'list.dnswl.org=127.[0..255].[0..255].0*-2'
  - 'list.dnswl.org=127.[0..255].[0..255].1*-3'
  - 'list.dnswl.org=127.[0..255].[0..255].[2..255]*-4'


# List of user-supplied smtpd restrictions, they will replace restrictions
# automatically created by templates.
postfix_smtpd_client_restrictions: []
postfix_smtpd_helo_restrictions: []
postfix_smtpd_sender_restrictions: []
postfix_smtpd_relay_restrictions: []
postfix_smtpd_recipient_restrictions: []
postfix_smtpd_data_restrictions: []


# List of default recipients for local aliases which have no recipients
# specified, by default current $USER managing Ansible
postfix_default_local_alias_recipients: ['{{ lookup("env","USER") }}']

# Hash of local aliases which will be merged with default aliases in
# vars/main.yml. Commented out example below.
postfix_local_aliases:
  #'alias': [ 'account1', 'account2' ]
  #'other': [ 'user@email', '"|/dir/command"' ]
  #'blackhole': [ '/dev/null' ]
  #'default_recipients':


# Custom configuration added at the end of /etc/postfix/main.cf (use text block)
postfix_local_maincf: False

# Custom configuration added at the end of /etc/postfix/master.cf (use text block)
postfix_local_mastercf: False


# This variable can be used in postfix dependency role definition to configure
# additional lists used in Postfix main.cf configuration file. This variable
# will be saved in Ansible facts and updated when necessary
postfix_dependent_lists: {}
  # Examples:

  # Include these lists in transport_maps option
  #transport_maps: ['hash:/etc/postfix/transport']

  # Include this alias map if Postfix has 'local' capability
  #alias_maps:
  #  - capability: 'local'
  #    list: [ 'hash:/etc/aliases' ]

  # Include this virtual alias map if Postfix does not have 'local' capability
  #virtual_alias_maps:
  #  - no_capability: 'local'
  #    list: [ 'hash:/etc/postfix/virtual_alias_maps' ]

# Here you can specify Postfix configuration options which should be enabled in
# main.cf using postfix dependency role definition. Configuration will be saved
# in Ansible facts and updated when necessary
postfix_dependent_maincf: []
  # Examples:

  # Set this option in main.cf
  #- param: 'local_destination_recipient_limit'
  #  value: '1'

  # Enable this option only if 'mx' is in Postfix capabilities
  #- param: 'defer_transports'
  #  value: 'smtp'
  #  capability: 'mx'

  # Enable this option only if 'local' is not in Postfix capabilities
  #- param: 'relayhost'
  #  value: 'mx.example.org'
  #  no_capability: 'local'

  # If no value is specified, check if a list of the same name as param exists
  # in postfix_dependent_lists and enable it
  #- param: 'virtual_alias_maps'

# This list can be used to configure services in Postfix master.cf using
# postfix dependency variables. Configured services will be saved in Ansible
# facts and updated when necessary
postfix_dependent_mastercf: []
  # Examples:

  # Minimal service using 'pipe' command
  #- service: 'mydaemon'
  #  type: 'unix'
  #  command: 'pipe'
  #  options: |
  #    flagsd=FR user=mydaemon:mydaemon
  #    argv=/usr/local/bin/mydaemon.sh ${nexthop} ${user}

  # Optional parameters from master.cf:
  # private, unpriv, chroot, wakeup, maxproc

  # You can also specify 'capability' or 'no_capability' to define when
  # a particular service should be configured


# List of clients and networks which will have access to XCLIENT protocol
# extension when 'test' postfix capability is enabled.
postfix_smtpd_authorized_xclient_hosts: ['127.0.0.1/32']


