---

- name: Enforce root system group
  group:
    name: 'root'
    gid: '0'
    system: True
    state: 'present'
  when: root_account__enabled|bool

- name: Enforce root system account
  user:
    name: 'root'
    state: 'present'
    group: 'root'
    home: '/root'
    uid: '0'
    groups: ''
    append: False
    system: True
    generate_ssh_key: '{{ root_account__generate_ssh_key }}'
    ssh_key_bits: '{{ root_account__ssh_keysize | d(omit) }}'
    password:         '{{ root_account__password if root_account__password else omit }}'
    shell:            '{{ root_account__shell if root_account__shell else omit }}'
  when: root_account__enabled|bool
  no_log: '{{ True if root_account__password else False }}'

- name: Enforce root home permissions
  file:
    path: '/root'
    state: 'directory'
    owner: 'root'
    group: 'root'
    mode: '0700'
  when: root_account__enabled|bool
